#include <tonc.h>
#include <stdlib.h>
#include <string.h>
#include "gfx_doodle.h"


OBJ_ATTR obj_buffer[128];
OBJ_AFFINE *obj_aff_buffer= (OBJ_AFFINE*)obj_buffer;
int obj_buffer_current=0;


void load_doodle_gfx(){
    memcpy(&tile_mem[5][0],gfx_doodleTiles,gfx_doodleTilesLen);
    memcpy(pal_obj_mem,gfx_doodlePal,gfx_doodlePalLen);
}
void draw_doodle(){
    OBJ_ATTR *spr= &obj_buffer[obj_buffer_current];
    obj_set_attr(spr,ATTR0_SQUARE,ATTR1_SIZE_16,ATTR2_BUILD(512,0,0));

    int x=36,y=80;
    obj_set_pos(spr,x,y);
    obj_buffer_current++;
}
int main() 
{
    irq_init(NULL);irq_add(II_VBLANK, NULL);
    oam_init(obj_buffer,128);
	REG_DISPCNT= DCNT_MODE3 | DCNT_BG2 | DCNT_OBJ | DCNT_OBJ_1D;
    load_doodle_gfx();
	while(1){
        VBlankIntrWait();
        draw_doodle();
        oam_copy(oam_mem,obj_buffer,128);
        // oam_init(obj_buffer,obj_buffer_current);
        obj_buffer_current=0;
    }
    return 0;
}


